"use strict";class NxRepeater_config{config(e){NxRepeater_config.$config=e}appendtype(){return"appendtype"in NxRepeater_config.$config?NxRepeater_config.$config.appendtype:"last"}clonetype(){return"clonetype"in NxRepeater_config.$config?NxRepeater_config.$config.clonetype:"last-item"}firstItemDelete(){return"firstItemDelete"in NxRepeater_config.$config&&NxRepeater_config.$config.firstItemDelete}whenDelete(){return"whenDelete"in NxRepeater_config.$config&&NxRepeater_config.$config.whenDelete}whenDeleteMessage(){return"whenDeleteMessage"in NxRepeater_config.$config?NxRepeater_config.$config.whenDeleteMessage:"Are you sure you want to delete this element?"}static instance(){return new NxRepeater_config}}class NxRepeater{config(e,t){NxRepeater_config.instance().config(t),NxRepeater.$class=e,this.render()}static instance(){return new NxRepeater}render(){let e=document.querySelectorAll(NxRepeater.$class);if(e)for(let t=0;t<e.length;t++)e[t]&&(this.$self=e[t],this.$self.setAttribute("data-id","nxrep-"+t),this.$self.addEventListener("mousedown",this.drag_index),this.setup_addButton(this.$self),this.setup_group(this.$self),this.indexRender(this.$self));new NxLoad_Default}indexRender(e){if(!e.hasAttribute("data-id"))return;let t=e.getAttribute("data-id"),r=e.querySelector('[data-id="group__'+t+'"]');if(!r)return;let a=r.getAttribute("data-group"),i=r.children;for(let e=0;e<i.length;e++){let t=i[e];if(!t)continue;let r=t.getAttribute("data-id");r||(t.setAttribute("data-id","nx-repeater_++"),r=t.getAttribute("data-id"));let d=r.replace("++",e);t.setAttribute("id",d);let l=t.querySelector("[data-group]");if(l){let t=l.getAttribute("data-group-config");t||($dataAtt=l.getAttribute("data-group"),l.setAttribute("data-group-config",$dataAtt),t=l.getAttribute("data-group-config"));let r=t.replace("++",e);l.setAttribute("data-group",r)}let s=t.querySelector("[data-delete]");s&&(s.addEventListener("click",this.remove_item),s.setAttribute("data-target",d));let o=t.querySelectorAll("input, select, textarea");if(o)for(let t=0;t<o.length;t++){let r=o[t],i=r.tagName.toLowerCase(),d=r.getAttribute("data-name");d||(r.setAttribute("data-name",i+"_"+e),d=r.getAttribute("data-name"));var n=d.replace("++",e);""!=a&&(n=a+n),r.setAttribute("name",n);let l=r.getAttribute("data-id");l||(r.setAttribute("data-id",i+"_++"),l=r.getAttribute("data-id"));let s=l.replace("++",e);r.setAttribute("id",s)}}}setup_group(e){if(e.hasAttribute("data-id")){let t=e.getAttribute("data-id");e.querySelector("[data-group]").setAttribute("data-id","group__"+t)}}setup_addButton(e){if(e.hasAttribute("data-id")){let t=e.getAttribute("data-id"),r=e.children[1];r.hasAttribute("data-create")&&(r.setAttribute("data-id","button__"+t),r.addEventListener("click",this.add_items))}}add_items(){let e=this.parentElement;if(!e)return;let t=NxRepeater_config.instance();if(e.hasAttribute("data-id")){let i=e.getAttribute("data-id");var r=e.querySelector('[data-id="group__'+i+'"]');if(!r)return;let n=r.lastElementChild;"first-item"===t.clonetype()&&(n=r.firstElementChild);var a=n.cloneNode(!0);"last"===t.appendtype()?r.appendChild(a):r.insertBefore(a,r.childNodes[0]),NxRepeater.instance().render()}}drag_index(){NxRepeater.instance().render()}remove_item(e){e.preventDefault();let t=NxRepeater_config.instance();if(t.whenDelete()&&!confirm(t.whenDeleteMessage()))return!1;let r=this.getAttribute("data-target");if(!r)return;let a=document.querySelector("#"+r);a&&a.remove(),NxRepeater.instance().render()}alertMessage(e){console.log(e)}}